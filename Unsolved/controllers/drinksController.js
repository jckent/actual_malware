var express = require("express");
var router = express.Router();
var passport = require("passport");
var request = require("request");
var db = require("../models");
var name, image, ingredients, instructions;
var ing = [];
var mes = [];
var app = express();


router.get("/", function(req,res){
    var obj = {
        ...name,
        ...image,
        ...ingredients,
        ...instructions
    }
    res.render("index", obj);
});

router.get("/uc", function(req,res) {
    thistuff();

    res.json();
});
router.get('/signup', function(req, res) {
    res.render('userCreate');
});
router.post('/signup', function(req, res, next) {
    db.User.create({
        userName: req.body.userName,
        password: req.body.password 
    })
    res.render('signupSuccess');
});
router.get('/profiles', function(req, res) {
    res.render('profiles');
});
router.get('/login', function(req, res) {
    res.render('login');
});
router.get("*", function(req, res) {
    res.render("404");
});



function thistuff() {
    var input = "tom";//process.argv;
console.log(input);
var unirest = require("unirest");

var req = unirest("GET", "https://www.thecocktaildb.com/api/json/v1/1/random.php");
req.query({
	"a": "list"
});
req.headers({
	"x-rapidapi-host": "the-cocktail-db.p.rapidapi.com",
	"x-rapidapi-key": "1bb40a3f2cmsh737e756f49ff562p1d4980jsn6537251a9bc1"
});

req.end(function (res) {
	if (res.error) throw new Error(res.error);
    var drAnks = res.body.drinks[0];
    console.log("body:",res.body);    
    console.log("spec:",res.body.drinks[0])
    console.log("==================",drAnks.strInstructions)
    name = {drink_name : drAnks.strDrink}
    image = {drink_image : drAnks.strDrinkThumb}
    instructions = {drink_instructions : drAnks.strInstructions}

    ings = [];    
    meas = [];
    ings.push(drAnks.strIngredient1,drAnks.strIngredient2,drAnks.strIngredient3,drAnks.strIngredient4,
        drAnks.strIngredient5,drAnks.strIngredient6,drAnks.strIngredient7,drAnks.strIngredient8,
        drAnks.strIngredient9,drAnks.strIngredient10,drAnks.strIngredient11,drAnks.strIngredient12,
        drAnks.strIngredient13,drAnks.strIngredient14,drAnks.strIngredient15
    )
    meas.push(drAnks.strMeasure1,drAnks.strMeasure2,drAnks.strMeasure3,drAnks.strMeasure4,
        drAnks.strMeasure5,drAnks.strMeasure6,drAnks.strMeasure7,drAnks.strMeasure8,
        drAnks.strMeasure9,drAnks.strMeasure10,drAnks.strMeasure11,drAnks.strMeasure12,
        drAnks.strMeasure13,drAnks.strMeasure14,drAnks.strMeasure15
    )
        var ingredientList = ings.map(function(ing,index) {
            if (ing) return {
                ingredient:ing,
                measurement:meas[index],
            } 
            else return false

        }).filter(function(ing) {
            return ing
        })
        ingredients = {drink_ingredients : ingredientList}
console.log (ingredientList);
    
    
});

}
module.exports = router;
